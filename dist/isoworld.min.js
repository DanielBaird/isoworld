/*! isoworld v0.0.1 | (c) 2014 Daniel Baird | blah licence */
!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.isoworld=t()}}(function(){return function t(e,n,o){function r(s,a){if(!n[s]){if(!e[s]){var h="function"==typeof require&&require;if(!a&&h)return h(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var u=n[s]={exports:{}};e[s][0].call(u.exports,function(t){var n=e[s][1][t];return r(n?n:t)},u,u.exports,t,e,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(t,e){e.exports=t("./js/isomer")},{"./js/isomer":4}],2:[function(t,e){function n(t){this.elem=t,this.ctx=this.elem.getContext("2d"),this.width=t.width,this.height=t.height}n.prototype.clear=function(){this.ctx.clearRect(0,0,this.width,this.height)},n.prototype.path=function(t,e){this.ctx.beginPath(),this.ctx.moveTo(t[0].x,t[0].y);for(var n=1;n<t.length;n++)this.ctx.lineTo(t[n].x,t[n].y);this.ctx.closePath(),this.ctx.save(),this.ctx.fillStyle=this.ctx.strokeStyle=e.toHex(),this.ctx.stroke(),this.ctx.fill(),this.ctx.restore()},e.exports=n},{}],3:[function(t,e){function n(t,e,n){this.r=parseInt(t||0),this.g=parseInt(e||0),this.b=parseInt(n||0),this.loadHSL()}n.prototype.toHex=function(){var t=(256*this.r*256+256*this.g+this.b).toString(16);return t.length<6&&(t=new Array(6-t.length+1).join("0")+t),"#"+t},n.prototype.lighten=function(t,e){e=e||new n(255,255,255);var o=new n(e.r/255*this.r,e.g/255*this.g,e.b/255*this.b);return o.l=Math.min(o.l+t,1),o.loadRGB(),o},n.prototype.loadHSL=function(){var t,e,n=this.r/255,o=this.g/255,r=this.b/255,i=Math.max(n,o,r),s=Math.min(n,o,r),a=(i+s)/2;if(i===s)t=e=0;else{var h=i-s;switch(e=a>.5?h/(2-i-s):h/(i+s),i){case n:t=(o-r)/h+(r>o?6:0);break;case o:t=(r-n)/h+2;break;case r:t=(n-o)/h+4}t/=6}this.h=t,this.s=e,this.l=a},n.prototype.loadRGB=function(){var t,e,n,o=this.h,r=this.s,i=this.l;if(0===r)t=e=n=i;else{var s=.5>i?i*(1+r):i+r-i*r,a=2*i-s;t=this._hue2rgb(a,s,o+1/3),e=this._hue2rgb(a,s,o),n=this._hue2rgb(a,s,o-1/3)}this.r=parseInt(255*t),this.g=parseInt(255*e),this.b=parseInt(255*n)},n.prototype._hue2rgb=function(t,e,n){return 0>n&&(n+=1),n>1&&(n-=1),1/6>n?t+6*(e-t)*n:.5>n?e:2/3>n?t+(e-t)*(2/3-n)*6:t},e.exports=n},{}],4:[function(t,e){function n(t,e){e=e||{},this.canvas=new o(t),this.angle=Math.PI/6,this.scale=e.scale||70,this.originX=e.originX||this.canvas.width/2,this.originY=e.originY||.9*this.canvas.height,this.lightPosition=e.lightPosition||new h(2,-1,3),this.lightAngle=this.lightPosition.normalize(),this.colorDifference=.2,this.lightColor=e.lightColor||new r(255,255,255)}var o=t("./canvas"),r=t("./color"),i=t("./path"),s=t("./point"),a=t("./shape"),h=t("./vector");n.prototype.setLightPosition=function(t,e,n){this.lightPosition=new h(t,e,n),this.lightAngle=this.lightPosition.normalize()},n.prototype._translatePoint=function(t){var e=new s(t.x*this.scale*Math.cos(this.angle),t.x*this.scale*Math.sin(this.angle)),n=new s(t.y*this.scale*Math.cos(Math.PI-this.angle),t.y*this.scale*Math.sin(Math.PI-this.angle)),o=this.originX+e.x+n.x,r=this.originY-e.y-n.y-t.z*this.scale;return new s(o,r)},n.prototype.add=function(t,e){if("[object Array]"==Object.prototype.toString.call(t))for(var n=0;n<t.length;n++)this.add(t[n],e);else if(t instanceof i)this._addPath(t,e);else if(t instanceof a){var o=t.orderedPaths();for(var n in o)this._addPath(o[n],e)}},n.prototype._addPath=function(t,e){e=e||new r(120,120,120);var n=h.fromTwoPoints(t.points[1],t.points[0]),o=h.fromTwoPoints(t.points[2],t.points[1]),i=h.crossProduct(n,o).normalize(),s=h.dotProduct(i,this.lightAngle);color=e.lighten(s*this.colorDifference,this.lightColor),this.canvas.path(t.points.map(this._translatePoint.bind(this)),color)},n.Canvas=o,n.Color=r,n.Path=i,n.Point=s,n.Shape=a,n.Vector=h,e.exports=n},{"./canvas":2,"./color":3,"./path":5,"./point":6,"./shape":7,"./vector":8}],5:[function(t,e){function n(t){this.points="[object Array]"===Object.prototype.toString.call(t)?t:Array.prototype.slice.call(arguments)}var o=t("./point");n.prototype.push=function(t){this.points.push(t)},n.prototype.reverse=function(){var t=Array.prototype.slice.call(this.points);return new n(t.reverse())},n.prototype.translate=function(){var t=arguments;return new n(this.points.map(function(e){return e.translate.apply(e,t)}))},n.prototype.rotateZ=function(){var t=arguments;return new n(this.points.map(function(e){return e.rotateZ.apply(e,t)}))},n.prototype.scale=function(){var t=arguments;return new n(this.points.map(function(e){return e.scale.apply(e,t)}))},n.prototype.depth=function(){var t,e=0;for(t=0;t<this.points.length;t++)e+=this.points[t].depth();return e/(this.points.length||1)},n.Rectangle=function(t,e,r){void 0===e&&(e=1),void 0===r&&(r=1);var i=new n([t,new o(t.x+e,t.y,t.z),new o(t.x+e,t.y+r,t.z),new o(t.x,t.y+r,t.z)]);return i},n.Circle=function(t,e,r){r=r||20;var i,s=new n;for(i=0;r>i;i++)s.push(new o(e*Math.cos(2*i*Math.PI/r),e*Math.sin(2*i*Math.PI/r),0));return s.translate(t.x,t.y,t.z)},n.Star=function(t,e,r,i){var s,a,h=new n;for(s=0;2*i>s;s++)a=s%2===0?e:r,h.push(new o(a*Math.cos(s*Math.PI/i),a*Math.sin(s*Math.PI/i),0));return h.translate(t.x,t.y,t.z)},e.exports=n},{"./point":6}],6:[function(t,e){function n(t,e,o){return this instanceof n?(this.x="number"==typeof t?t:0,this.y="number"==typeof e?e:0,this.z="number"==typeof o?o:0,void 0):new n(t,e,o)}n.ORIGIN=new n(0,0,0),n.prototype.translate=function(t,e,o){return new n(this.x+t,this.y+e,this.z+o)},n.prototype.scale=function(t,e,n,o){var r=this.translate(-t.x,-t.y,-t.z);return void 0===n&&void 0===o?n=o=e:o="number"==typeof o?o:1,r.x*=e,r.y*=n,r.z*=o,r.translate(t.x,t.y,t.z)},n.prototype.rotateZ=function(t,e){var n=this.translate(-t.x,-t.y,-t.z),o=n.x*Math.cos(e)-n.y*Math.sin(e),r=n.x*Math.sin(e)+n.y*Math.cos(e);return n.x=o,n.y=r,n.translate(t.x,t.y,t.z)},n.prototype.depth=function(){return this.x+this.y-2*this.z},n.distance=function(t,e){var n=e.x-t.x,o=e.y-t.y,r=e.z-t.z;return Math.sqrt(n*n+o*o+r*r)},e.exports=n},{}],7:[function(t,e){function n(t){this.paths="[object Array]"===Object.prototype.toString.call(t)?t:Array.prototype.slice.call(arguments)}var o=t("./path"),r=t("./point");n.prototype.push=function(t){this.paths.push(t)},n.prototype.translate=function(){var t=arguments;return new n(this.paths.map(function(e){return e.translate.apply(e,t)}))},n.prototype.rotateZ=function(){var t=arguments;return new n(this.paths.map(function(e){return e.rotateZ.apply(e,t)}))},n.prototype.scale=function(){var t=arguments;return new n(this.paths.map(function(e){return e.scale.apply(e,t)}))},n.prototype.orderedPaths=function(){var t=this.paths.slice();return t.sort(function(t,e){return e.depth()-t.depth()})},n.extrude=function(t,e){e="number"==typeof e?e:1;var r,i=t.translate(0,0,e),s=new n;for(s.push(t.reverse()),s.push(i),r=0;r<t.points.length;r++)s.push(new o([i.points[r],t.points[r],t.points[(r+1)%t.points.length],i.points[(r+1)%i.points.length]]));return s},n.Prism=function(t,e,i,s){e="number"==typeof e?e:1,i="number"==typeof i?i:1,s="number"==typeof s?s:1;var a=new n,h=new o([t,new r(t.x+e,t.y,t.z),new r(t.x+e,t.y,t.z+s),new r(t.x,t.y,t.z+s)]);a.push(h),a.push(h.reverse().translate(0,i,0));var u=new o([t,new r(t.x,t.y,t.z+s),new r(t.x,t.y+i,t.z+s),new r(t.x,t.y+i,t.z)]);a.push(u),a.push(u.reverse().translate(e,0,0));var p=new o([t,new r(t.x+e,t.y,t.z),new r(t.x+e,t.y+i,t.z),new r(t.x,t.y+i,t.z)]);return a.push(p.reverse()),a.push(p.translate(0,0,s)),a},n.Pyramid=function(t,e,i,s){e="number"==typeof e?e:1,i="number"==typeof i?i:1,s="number"==typeof s?s:1;var a=new n,h=new o([t,new r(t.x+e,t.y,t.z),new r(t.x+e/2,t.y+i/2,t.z+s)]);a.push(h),a.push(h.rotateZ(t.translate(e/2,i/2),Math.PI));var u=new o([t,new r(t.x+e/2,t.y+i/2,t.z+s),new r(t.x,t.y+i,t.z)]);return a.push(u),a.push(u.rotateZ(t.translate(e/2,i/2),Math.PI)),a},n.Cylinder=function(t,e,r,i){e="number"==typeof e?e:1;var s=o.Circle(t,e,r),a=n.extrude(s,i);return a},e.exports=n},{"./path":5,"./point":6}],8:[function(t,e){function n(t,e,n){this.i="number"==typeof t?t:0,this.j="number"==typeof e?e:0,this.k="number"==typeof n?n:0}n.fromTwoPoints=function(t,e){return new n(e.x-t.x,e.y-t.y,e.z-t.z)},n.crossProduct=function(t,e){var o=t.j*e.k-e.j*t.k,r=-1*(t.i*e.k-e.i*t.k),i=t.i*e.j-e.i*t.j;return new n(o,r,i)},n.dotProduct=function(t,e){return t.i*e.i+t.j*e.j+t.k*e.k},n.prototype.magnitude=function(){return Math.sqrt(this.i*this.i+this.j*this.j+this.k*this.k)},n.prototype.normalize=function(){var t=this.magnitude();return new n(this.i/t,this.j/t,this.k/t)},e.exports=n},{}],9:[function(t,e){e.exports=t("./worlds/allworlds.js")},{"./worlds/allworlds.js":13}],10:[function(t,e){function n(t,e,n,o,r,i){this.cX=t,this.cY=e,this.bZ=n;var s=o/2;this.x=t-s,this.y=e-s,this.z=n,this.w=o,this.h=r,this.color=i}n.prototype.render=function(){},e.exports=n},{}],11:[function(t,e){function n(t,e,n,r,i){o.call(this,t,e,n,1,r,i)}var o=t("./block.js");e.exports=n},{"./block.js":10}],12:[function(){"function"!=typeof Object.create&&!function(){var t=function(){};Object.create=function(e){if(arguments.length>1)throw Error("Second argument not supported");if(null===e)throw Error("Cannot set a null [[Prototype]]");if("object"!=typeof e)throw TypeError("Argument must be an object");return t.prototype=e,new t}}()},{}],13:[function(t,e){var n=t("./worlddefaults.js"),o=t("./forestworld.js"),r=t("../../bower_components/isomer/index.js"),i={defaultOptions:n,Color:r.Color,Forest:o};window.World=i,e.exports=i},{"../../bower_components/isomer/index.js":1,"./forestworld.js":15,"./worlddefaults.js":16}],14:[function(t,e){function n(t,e){this._opts=Object.create(o),this.mergeOptions(e),this._squares=[[]],this.makeLayers(t)}t("../util/shims.js");var o=t("./worlddefaults.js"),r=t("../../bower_components/isomer/index.js"),i=t("../objects/unitcolumn.js");n.prototype.makeLayers=function(t){this._dom=t instanceof Element?t:document.getElementById(t);var e=this._dom.clientWidth,n=this._dom.clientHeight;this._dom.innerHTML='<canvas id="isoworld-bg" width="'+e+'" height="'+n+'"></canvas><canvas id="isoworld-fg" width="'+e+'" height="'+n+'"></canvas><canvas id="isoworld-ui" width="'+e+'" height="'+n+'"></canvas>',this._layers={bg:new r(document.getElementById("isoworld-bg")),fg:new r(document.getElementById("isoworld-fg")),ui:new r(document.getElementById("isoworld-ui"))}},n.prototype.mergeOptions=function(t){for(opt in t)this._opts[opt]=t[opt]},n.prototype.autoRender=function(t){return t===!1?this._opts.autoRender=!1:1==t&&(this._opts.autoRender=!0),this._opts.autoRender},n.prototype.ground=function(t,e,n,o){var r,s,a,h=this._opts.bedrockDepth+n,u=[];if(o instanceof Array)for(r=0;r<o.length;r+=2)a=o[r],s=r<o.length-1?Math.min(o[r+1],h):h,h-=s,u.unshift(new i(t,e,n-h,s,a));else u.unshift(new i(t,e,0-h,h+n,o));this.groundStack(t,e,u),this.renderMaybe()},n.prototype.ensureExists=function(t,e){this._squares.length<t&&(this._squares.length=t),void 0===this._squares[t]&&(this._squares[t]=Array(e)),this._squares[t].length<e&&(this._squares[t].length=e),void 0===this._squares[t][e]&&(this._squares[t][e]={}),this._squares[0].length<e&&(this._squares[0].length=e)},n.prototype.groundStack=function(t,e,n){this.ensureExists(t,e),this._squares[t][e].ground=n},n.prototype.renderSquare=function(t,e){var n,o=this._layers.fg,r=this._squares[t][e];for(n in r.ground)o.add()},n.prototype.render=function(){this._layers.fg.canvas.clear();for(var t,e,n=this._squares,o=n.length-1,r=n[0].length-1,i=o+r;i>=0;){for(t=0;o>=t;t++)for(e=0;r>=e;e++)t+e==i&&n[t][e]&&renderSquare(t,e);i-=1}},n.prototype.renderMaybe=function(){this._autoRender&&this.render()},e.exports=n},{"../../bower_components/isomer/index.js":1,"../objects/unitcolumn.js":11,"../util/shims.js":12,"./worlddefaults.js":16}],15:[function(t,e){function n(){o.apply(this,arguments)}t("../util/shims.js");var o=t("./baseworld.js");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,e.exports=n},{"../util/shims.js":12,"./baseworld.js":14}],16:[function(t,e){var n={autoRender:!0,bedrockDepth:5,groundScale:1.5,heightScale:1,interBlockGap:.05,dummy:"final thing with no trailing comma"};e.exports=n},{}]},{},[9])(9)});